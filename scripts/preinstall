#!/usr/bin/env bash

DEPS=`pwd`/deps


BAREBONES=`pwd`/../nodeos-barebones

TOOLCHAIN=$BAREBONES/node_modules/nodeos-cross-toolchain
TOOLS=$TOOLCHAIN/out

source $TOOLCHAIN/scripts/adjustEnvVars.sh || exit $?


#
# genfatfs
#

SRC_DIR=$DEPS/genfatfs
if [[ ! -d $SRC_DIR ]]; then
  mkdir -p `dirname $SRC_DIR`

  curl -L https://github.com/NodeOS/genfatfs/archive/master.zip > master.zip &&
  unzip master.zip                                                           &&
  mv genfatfs-master $SRC_DIR                                                &&
  rm master.zip                                                              || exit 10

  (
    cd $SRC_DIR &&
    $MAKE       || exit 22
  ) || exit $?
fi
